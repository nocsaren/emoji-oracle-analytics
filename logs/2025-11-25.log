2025-11-25 11:11:44,789      INFO      __main__                                Starting pipeline...
2025-11-25 11:11:44,789      INFO      __main__                                Validating folder structure...
2025-11-25 11:11:44,790      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/csv
2025-11-25 11:11:44,790      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/parquet
2025-11-25 11:11:44,790      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/logs
2025-11-25 11:11:44,790      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/docs
2025-11-25 11:11:44,790      INFO      pipeline.utils.main_functions           All folder structures validated.
2025-11-25 11:11:44,790      INFO      __main__                                Initializing BigQuery client...
2025-11-25 11:11:44,792      INFO      __main__                                BigQuery client initialized.
2025-11-25 11:11:44,793      INFO      __main__                                Starting data pull...
2025-11-25 11:11:44,805      INFO      pipeline.utils.staging                  Running pull_from_bq...
2025-11-25 11:11:46,707      INFO      pipeline.utils.pull_functions           Processing events_20251120...
2025-11-25 11:11:49,705      INFO      pipeline.utils.pull_functions           Fetched 1025 rows from events_20251120
2025-11-25 11:11:49,705      INFO      pipeline.utils.pull_functions           Processing events_20251121...
2025-11-25 11:11:53,364      INFO      pipeline.utils.pull_functions           Fetched 1004 rows from events_20251121
2025-11-25 11:11:53,364      INFO      pipeline.utils.pull_functions           Processing events_20251122...
2025-11-25 11:11:55,522      INFO      pipeline.utils.pull_functions           Fetched 329 rows from events_20251122
2025-11-25 11:11:55,522      INFO      pipeline.utils.pull_functions           Processing events_20251123...
2025-11-25 11:11:56,817      INFO      pipeline.utils.pull_functions           Fetched 220 rows from events_20251123
2025-11-25 11:11:56,817      INFO      pipeline.utils.pull_functions           Processing events_20251124...
2025-11-25 11:11:58,184      INFO      pipeline.utils.pull_functions           Fetched 98 rows from events_20251124
2025-11-25 11:11:58,184      INFO      pipeline.utils.pull_functions           Merging data...
2025-11-25 11:11:58,343      INFO      pipeline.utils.staging                  pull_from_bq done.
2025-11-25 11:11:58,343      INFO      pipeline.utils.staging                  Running filter_events_by_date...
2025-11-25 11:11:58,345      INFO      pipeline.utils.main_functions           Filtered events from 2676 to 2204 based on start date 2025-11-20 00:00:00+00:00.
2025-11-25 11:11:58,346      INFO      pipeline.utils.staging                  filter_events_by_date done.
2025-11-25 11:11:58,346      INFO      pipeline.utils.staging                  Running flatten_dataframe...
2025-11-25 11:11:58,743      INFO      pipeline.utils.staging                  flatten_dataframe done.
2025-11-25 11:11:58,743      INFO      pipeline.utils.staging                  Running dots_to_underscores...
2025-11-25 11:11:58,744      INFO      pipeline.utils.cleaning_functions       Column names updated to use '__' instead of '.' successfully.
2025-11-25 11:11:58,744      INFO      pipeline.utils.staging                  dots_to_underscores done.
2025-11-25 11:11:58,744      INFO      pipeline.utils.staging                  Running transform_datetime_fields...
2025-11-25 11:11:58,755      INFO      pipeline.utils.time_and_date_functions  Date/time cleanup and transformation complete.
2025-11-25 11:11:58,756      INFO      pipeline.utils.staging                  transform_datetime_fields done.
2025-11-25 11:11:58,756      INFO      pipeline.utils.staging                  Running add_time_based_features...
2025-11-25 11:11:58,760      INFO      pipeline.utils.time_and_date_functions  Time-based features added successfully.
2025-11-25 11:11:58,760      INFO      pipeline.utils.staging                  add_time_based_features done.
2025-11-25 11:11:58,760      INFO      pipeline.utils.staging                  Running add_durations...
2025-11-25 11:11:58,807      INFO      pipeline.utils.time_and_date_functions  Session IDs assigned and durations calculated for 24 unique sessions.
2025-11-25 11:11:58,812      INFO      pipeline.utils.time_and_date_functions  Event durations within sessions calculated successfully.
2025-11-25 11:11:58,813      INFO      pipeline.utils.staging                  add_durations done.
2025-11-25 11:11:58,813      INFO      pipeline.utils.staging                  Running forward_fill_progress...
2025-11-25 11:11:58,820      INFO      pipeline.utils.feature_engineering      Character names, tiers, and question indices forward-filled for 24 unique sessions.
2025-11-25 11:11:58,821      INFO      pipeline.utils.staging                  forward_fill_progress done.
2025-11-25 11:11:58,821      INFO      pipeline.utils.staging                  Running question_index_cleanup...
2025-11-25 11:11:58,829      INFO      pipeline.utils.cleaning_functions       Question index cleaned up for 2040 rows.
2025-11-25 11:11:58,829      INFO      pipeline.utils.staging                  question_index_cleanup done.
2025-11-25 11:11:58,829      INFO      pipeline.utils.staging                  Running question_cumulative_qi...
2025-11-25 11:11:58,836      INFO      pipeline.utils.feature_engineering      Cumulative question index calculated for 2040 rows.
2025-11-25 11:11:58,836      INFO      pipeline.utils.staging                  question_cumulative_qi done.
2025-11-25 11:11:58,836      INFO      pipeline.utils.staging                  Running mini_game_features...
2025-11-25 11:11:58,839      INFO      pipeline.utils.feature_engineering      Extracted maze hand data for 16 rows.
2025-11-25 11:11:58,840      INFO      pipeline.utils.staging                  mini_game_features done.
2025-11-25 11:11:58,840      INFO      pipeline.utils.staging                  Running mini_game_reward_split...
2025-11-25 11:11:58,844      INFO      pipeline.utils.feature_engineering      Extracted buff data for 9 rows.
2025-11-25 11:11:58,844      INFO      pipeline.utils.staging                  mini_game_reward_split done.
2025-11-25 11:11:58,844      INFO      pipeline.utils.staging                  Running mini_game_buffs...
2025-11-25 11:11:58,846      INFO      pipeline.utils.feature_engineering      Extracted earned buff data for 4 rows.
2025-11-25 11:11:58,846      INFO      pipeline.utils.staging                  mini_game_buffs done.
2025-11-25 11:11:58,846      INFO      pipeline.utils.staging                  Running mini_game_dolls...
2025-11-25 11:11:58,848      INFO      pipeline.utils.feature_engineering      Extracted doll data for 2 rows.
2025-11-25 11:11:58,848      INFO      pipeline.utils.staging                  mini_game_dolls done.
2025-11-25 11:11:58,848      INFO      pipeline.utils.staging                  Running currency_define_permanent...
2025-11-25 11:11:58,851      INFO      pipeline.utils.feature_engineering      Extracted permanent shop item data for 4 rows.
2025-11-25 11:11:58,851      INFO      pipeline.utils.staging                  currency_define_permanent done.
2025-11-25 11:11:58,851      INFO      pipeline.utils.staging                  Running currency_define_consumable...
2025-11-25 11:11:58,853      INFO      pipeline.utils.feature_engineering      Extracted consumable shop item data for 38 rows.
2025-11-25 11:11:58,853      INFO      pipeline.utils.staging                  currency_define_consumable done.
2025-11-25 11:11:58,853      INFO      pipeline.utils.staging                  Running currency_define_board...
2025-11-25 11:11:58,855      INFO      pipeline.utils.feature_engineering      Extracted board item data for 6 rows.
2025-11-25 11:11:58,855      INFO      pipeline.utils.staging                  currency_define_board done.
2025-11-25 11:11:58,855      INFO      pipeline.utils.staging                  Running currency_define_keys...
2025-11-25 11:11:58,856      INFO      pipeline.utils.feature_engineering      Defined keys in spent_to for 0 rows.
2025-11-25 11:11:58,856      INFO      pipeline.utils.staging                  currency_define_keys done.
2025-11-25 11:11:58,856      INFO      pipeline.utils.staging                  Running apply_value_maps...
2025-11-25 11:11:58,865      WARNING   pipeline.utils.cleaning_functions       'event_params__ad_shown_where' not found in DataFrame.
2025-11-25 11:11:58,869      INFO      pipeline.utils.staging                  apply_value_maps done.
2025-11-25 11:11:58,869      INFO      pipeline.utils.staging                  Running question_addressable_index...
2025-11-25 11:11:58,872      INFO      pipeline.utils.feature_engineering      Question address created for 2040 rows.
2025-11-25 11:11:58,872      INFO      pipeline.utils.staging                  question_addressable_index done.
2025-11-25 11:11:58,872      INFO      pipeline.utils.staging                  Running question_answer_wrong_zeros...
2025-11-25 11:11:58,873      INFO      pipeline.utils.feature_engineering      Filled NaN values in 'event_params__answered_wrong' with 0 for 'Question Completed' events.
2025-11-25 11:11:58,873      INFO      pipeline.utils.staging                  question_answer_wrong_zeros done.
2025-11-25 11:11:58,874      INFO      __main__                                Data pipeline executed successfully.
2025-11-25 11:11:58,874      INFO      __main__                                Generating dataframes...
2025-11-25 11:11:58,978      INFO      pipeline.utils.split_functions          Session-level dataframe created with 17 records and 27 columns.
2025-11-25 11:11:59,003      INFO      pipeline.utils.split_functions          User-level dataframe created with 6 records and 23 columns.
2025-11-25 11:11:59,012      INFO      pipeline.utils.split_functions          Question-level dataframe created with 411 records and 22 columns.
2025-11-25 11:11:59,016      INFO      pipeline.utils.split_functions          Rewarded ads dataframe created with 124 records and 20 columns.
2025-11-25 11:11:59,033      INFO      pipeline.utils.split_functions          Date-level dataframe created with 5 records and 14 columns.
2025-11-25 11:11:59,040      INFO      pipeline.utils.split_functions          Technical events dataframe created with 6 records and 163 columns.
2025-11-25 11:11:59,047      INFO      pipeline.utils.dataframes               All split dataframes successfully created.
2025-11-25 11:11:59,047      INFO      __main__                                Dataframes generated successfully.
2025-11-25 11:11:59,047      INFO      __main__                                Calculating KPIs...
2025-11-25 11:11:59,071      INFO      pipeline.utils.calculate_kpis           ✅ KPIs calculated.
2025-11-25 11:11:59,275      INFO      __main__                                Data pipeline complete. Processed data saved.
2025-11-25 11:55:04,134      INFO      __main__                                Starting pipeline...
2025-11-25 11:55:04,134      INFO      __main__                                Validating folder structure...
2025-11-25 11:55:04,134      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/csv
2025-11-25 11:55:04,134      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/parquet
2025-11-25 11:55:04,134      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/logs
2025-11-25 11:55:04,134      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/docs
2025-11-25 11:55:04,134      INFO      pipeline.utils.main_functions           All folder structures validated.
2025-11-25 11:55:04,135      INFO      __main__                                Initializing BigQuery client...
2025-11-25 11:55:04,136      INFO      __main__                                BigQuery client initialized.
2025-11-25 11:55:04,137      INFO      __main__                                Starting data pull...
2025-11-25 11:55:04,148      INFO      pipeline.utils.staging                  Running pull_from_bq...
2025-11-25 11:55:05,849      INFO      pipeline.utils.pull_functions           No new tables to process.
2025-11-25 11:55:05,849      INFO      pipeline.utils.pull_functions           Merging data...
2025-11-25 11:55:06,014      INFO      pipeline.utils.staging                  pull_from_bq done.
2025-11-25 11:55:06,014      INFO      pipeline.utils.staging                  Running filter_events_by_date...
2025-11-25 11:55:06,016      INFO      pipeline.utils.main_functions           Filtered events from 2676 to 2204 based on start date 2025-11-20 00:00:00+00:00.
2025-11-25 11:55:06,018      INFO      pipeline.utils.staging                  filter_events_by_date done.
2025-11-25 11:55:06,018      INFO      pipeline.utils.staging                  Running flatten_dataframe...
2025-11-25 11:55:06,367      INFO      pipeline.utils.staging                  flatten_dataframe done.
2025-11-25 11:55:06,367      INFO      pipeline.utils.staging                  Running dots_to_underscores...
2025-11-25 11:55:06,367      INFO      pipeline.utils.cleaning_functions       Column names updated to use '__' instead of '.' successfully.
2025-11-25 11:55:06,367      INFO      pipeline.utils.staging                  dots_to_underscores done.
2025-11-25 11:55:06,367      INFO      pipeline.utils.staging                  Running transform_datetime_fields...
2025-11-25 11:55:06,379      INFO      pipeline.utils.time_and_date_functions  Date/time cleanup and transformation complete.
2025-11-25 11:55:06,380      INFO      pipeline.utils.staging                  transform_datetime_fields done.
2025-11-25 11:55:06,380      INFO      pipeline.utils.staging                  Running add_time_based_features...
2025-11-25 11:55:06,384      INFO      pipeline.utils.time_and_date_functions  Time-based features added successfully.
2025-11-25 11:55:06,384      INFO      pipeline.utils.staging                  add_time_based_features done.
2025-11-25 11:55:06,384      INFO      pipeline.utils.staging                  Running add_durations...
2025-11-25 11:55:06,430      INFO      pipeline.utils.time_and_date_functions  Session IDs assigned and durations calculated for 24 unique sessions.
2025-11-25 11:55:06,434      INFO      pipeline.utils.time_and_date_functions  Event durations within sessions calculated successfully.
2025-11-25 11:55:06,435      INFO      pipeline.utils.staging                  add_durations done.
2025-11-25 11:55:06,435      INFO      pipeline.utils.staging                  Running forward_fill_progress...
2025-11-25 11:55:06,444      INFO      pipeline.utils.feature_engineering      Character names, tiers, and question indices forward-filled for 24 unique sessions.
2025-11-25 11:55:06,444      INFO      pipeline.utils.staging                  forward_fill_progress done.
2025-11-25 11:55:06,445      INFO      pipeline.utils.staging                  Running question_index_cleanup...
2025-11-25 11:55:06,452      INFO      pipeline.utils.cleaning_functions       Question index cleaned up for 2040 rows.
2025-11-25 11:55:06,452      INFO      pipeline.utils.staging                  question_index_cleanup done.
2025-11-25 11:55:06,452      INFO      pipeline.utils.staging                  Running question_cumulative_qi...
2025-11-25 11:55:06,458      INFO      pipeline.utils.feature_engineering      Cumulative question index calculated for 2040 rows.
2025-11-25 11:55:06,458      INFO      pipeline.utils.staging                  question_cumulative_qi done.
2025-11-25 11:55:06,458      INFO      pipeline.utils.staging                  Running mini_game_features...
2025-11-25 11:55:06,461      INFO      pipeline.utils.feature_engineering      Extracted maze hand data for 16 rows.
2025-11-25 11:55:06,461      INFO      pipeline.utils.staging                  mini_game_features done.
2025-11-25 11:55:06,461      INFO      pipeline.utils.staging                  Running mini_game_reward_split...
2025-11-25 11:55:06,465      INFO      pipeline.utils.feature_engineering      Extracted buff data for 9 rows.
2025-11-25 11:55:06,465      INFO      pipeline.utils.staging                  mini_game_reward_split done.
2025-11-25 11:55:06,465      INFO      pipeline.utils.staging                  Running mini_game_buffs...
2025-11-25 11:55:06,467      INFO      pipeline.utils.feature_engineering      Extracted earned buff data for 4 rows.
2025-11-25 11:55:06,467      INFO      pipeline.utils.staging                  mini_game_buffs done.
2025-11-25 11:55:06,467      INFO      pipeline.utils.staging                  Running mini_game_dolls...
2025-11-25 11:55:06,469      INFO      pipeline.utils.feature_engineering      Extracted doll data for 2 rows.
2025-11-25 11:55:06,469      INFO      pipeline.utils.staging                  mini_game_dolls done.
2025-11-25 11:55:06,469      INFO      pipeline.utils.staging                  Running currency_define_permanent...
2025-11-25 11:55:06,471      INFO      pipeline.utils.feature_engineering      Extracted permanent shop item data for 4 rows.
2025-11-25 11:55:06,471      INFO      pipeline.utils.staging                  currency_define_permanent done.
2025-11-25 11:55:06,471      INFO      pipeline.utils.staging                  Running currency_define_consumable...
2025-11-25 11:55:06,473      INFO      pipeline.utils.feature_engineering      Extracted consumable shop item data for 38 rows.
2025-11-25 11:55:06,474      INFO      pipeline.utils.staging                  currency_define_consumable done.
2025-11-25 11:55:06,474      INFO      pipeline.utils.staging                  Running currency_define_board...
2025-11-25 11:55:06,475      INFO      pipeline.utils.feature_engineering      Extracted board item data for 6 rows.
2025-11-25 11:55:06,475      INFO      pipeline.utils.staging                  currency_define_board done.
2025-11-25 11:55:06,475      INFO      pipeline.utils.staging                  Running currency_define_keys...
2025-11-25 11:55:06,476      INFO      pipeline.utils.feature_engineering      Defined keys in spent_to for 0 rows.
2025-11-25 11:55:06,476      INFO      pipeline.utils.staging                  currency_define_keys done.
2025-11-25 11:55:06,476      INFO      pipeline.utils.staging                  Running apply_value_maps...
2025-11-25 11:55:06,487      WARNING   pipeline.utils.cleaning_functions       'event_params__ad_shown_where' not found in DataFrame.
2025-11-25 11:55:06,491      INFO      pipeline.utils.staging                  apply_value_maps done.
2025-11-25 11:55:06,491      INFO      pipeline.utils.staging                  Running question_addressable_index...
2025-11-25 11:55:06,493      INFO      pipeline.utils.feature_engineering      Question address created for 2040 rows.
2025-11-25 11:55:06,493      INFO      pipeline.utils.staging                  question_addressable_index done.
2025-11-25 11:55:06,493      INFO      pipeline.utils.staging                  Running question_answer_wrong_zeros...
2025-11-25 11:55:06,494      INFO      pipeline.utils.feature_engineering      Filled NaN values in 'event_params__answered_wrong' with 0 for 'Question Completed' events.
2025-11-25 11:55:06,494      INFO      pipeline.utils.staging                  question_answer_wrong_zeros done.
2025-11-25 11:55:06,494      INFO      __main__                                Data pipeline executed successfully.
2025-11-25 11:55:06,494      INFO      __main__                                Generating dataframes...
2025-11-25 11:55:06,598      INFO      pipeline.utils.split_functions          Session-level dataframe created with 17 records and 27 columns.
2025-11-25 11:55:06,621      INFO      pipeline.utils.split_functions          User-level dataframe created with 6 records and 23 columns.
2025-11-25 11:55:06,629      INFO      pipeline.utils.split_functions          Question-level dataframe created with 411 records and 22 columns.
2025-11-25 11:55:06,632      INFO      pipeline.utils.split_functions          Rewarded ads dataframe created with 124 records and 20 columns.
2025-11-25 11:55:06,647      INFO      pipeline.utils.split_functions          Date-level dataframe created with 5 records and 14 columns.
2025-11-25 11:55:06,654      INFO      pipeline.utils.split_functions          Technical events dataframe created with 6 records and 163 columns.
2025-11-25 11:55:06,661      INFO      pipeline.utils.dataframes               All split dataframes successfully created.
2025-11-25 11:55:06,661      INFO      __main__                                Dataframes generated successfully.
2025-11-25 11:55:06,661      INFO      __main__                                Calculating KPIs...
2025-11-25 11:55:06,685      INFO      pipeline.utils.calculate_kpis           ✅ KPIs calculated.
2025-11-25 11:55:06,881      INFO      __main__                                Data pipeline complete. Processed data saved.
2025-11-25 12:07:35,653      INFO      __main__                                Starting pipeline...
2025-11-25 12:07:35,653      INFO      __main__                                Validating folder structure...
2025-11-25 12:07:35,654      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/csv
2025-11-25 12:07:35,654      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/parquet
2025-11-25 12:07:35,654      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/logs
2025-11-25 12:07:35,654      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/docs
2025-11-25 12:07:35,654      INFO      pipeline.utils.main_functions           All folder structures validated.
2025-11-25 12:07:35,654      INFO      __main__                                Initializing BigQuery client...
2025-11-25 12:07:35,656      INFO      __main__                                BigQuery client initialized.
2025-11-25 12:07:35,657      INFO      __main__                                Starting data pull...
2025-11-25 12:07:35,669      INFO      pipeline.utils.staging                  Running pull_from_bq...
2025-11-25 12:07:37,374      INFO      pipeline.utils.pull_functions           No new tables to process.
2025-11-25 12:07:37,374      INFO      pipeline.utils.pull_functions           Merging data...
2025-11-25 12:07:37,536      INFO      pipeline.utils.staging                  pull_from_bq done.
2025-11-25 12:07:37,536      INFO      pipeline.utils.staging                  Running filter_events_by_date...
2025-11-25 12:07:37,538      INFO      pipeline.utils.main_functions           Filtered events from 2676 to 2204 based on start date 2025-11-20 00:00:00+00:00.
2025-11-25 12:07:37,540      INFO      pipeline.utils.staging                  filter_events_by_date done.
2025-11-25 12:07:37,540      INFO      pipeline.utils.staging                  Running flatten_dataframe...
2025-11-25 12:07:37,927      INFO      pipeline.utils.staging                  flatten_dataframe done.
2025-11-25 12:07:37,927      INFO      pipeline.utils.staging                  Running dots_to_underscores...
2025-11-25 12:07:37,928      INFO      pipeline.utils.cleaning_functions       Column names updated to use '__' instead of '.' successfully.
2025-11-25 12:07:37,928      INFO      pipeline.utils.staging                  dots_to_underscores done.
2025-11-25 12:07:37,928      INFO      pipeline.utils.staging                  Running transform_datetime_fields...
2025-11-25 12:07:37,940      INFO      pipeline.utils.time_and_date_functions  Date/time cleanup and transformation complete.
2025-11-25 12:07:37,940      INFO      pipeline.utils.staging                  transform_datetime_fields done.
2025-11-25 12:07:37,940      INFO      pipeline.utils.staging                  Running add_time_based_features...
2025-11-25 12:07:37,945      INFO      pipeline.utils.time_and_date_functions  Time-based features added successfully.
2025-11-25 12:07:37,945      INFO      pipeline.utils.staging                  add_time_based_features done.
2025-11-25 12:07:37,945      INFO      pipeline.utils.staging                  Running add_durations...
2025-11-25 12:07:37,993      INFO      pipeline.utils.time_and_date_functions  Session IDs assigned and durations calculated for 24 unique sessions.
2025-11-25 12:07:37,997      INFO      pipeline.utils.time_and_date_functions  Event durations within sessions calculated successfully.
2025-11-25 12:07:37,998      INFO      pipeline.utils.staging                  add_durations done.
2025-11-25 12:07:37,998      INFO      pipeline.utils.staging                  Running forward_fill_progress...
2025-11-25 12:07:38,007      INFO      pipeline.utils.feature_engineering      Character names, tiers, and question indices forward-filled for 24 unique sessions.
2025-11-25 12:07:38,007      INFO      pipeline.utils.staging                  forward_fill_progress done.
2025-11-25 12:07:38,007      INFO      pipeline.utils.staging                  Running question_index_cleanup...
2025-11-25 12:07:38,016      INFO      pipeline.utils.cleaning_functions       Question index cleaned up for 2040 rows.
2025-11-25 12:07:38,016      INFO      pipeline.utils.staging                  question_index_cleanup done.
2025-11-25 12:07:38,016      INFO      pipeline.utils.staging                  Running question_cumulative_qi...
2025-11-25 12:07:38,023      INFO      pipeline.utils.feature_engineering      Cumulative question index calculated for 2040 rows.
2025-11-25 12:07:38,023      INFO      pipeline.utils.staging                  question_cumulative_qi done.
2025-11-25 12:07:38,023      INFO      pipeline.utils.staging                  Running mini_game_features...
2025-11-25 12:07:38,026      INFO      pipeline.utils.feature_engineering      Extracted maze hand data for 16 rows.
2025-11-25 12:07:38,027      INFO      pipeline.utils.staging                  mini_game_features done.
2025-11-25 12:07:38,027      INFO      pipeline.utils.staging                  Running mini_game_reward_split...
2025-11-25 12:07:38,031      INFO      pipeline.utils.feature_engineering      Extracted buff data for 9 rows.
2025-11-25 12:07:38,031      INFO      pipeline.utils.staging                  mini_game_reward_split done.
2025-11-25 12:07:38,031      INFO      pipeline.utils.staging                  Running mini_game_buffs...
2025-11-25 12:07:38,033      INFO      pipeline.utils.feature_engineering      Extracted earned buff data for 4 rows.
2025-11-25 12:07:38,033      INFO      pipeline.utils.staging                  mini_game_buffs done.
2025-11-25 12:07:38,033      INFO      pipeline.utils.staging                  Running mini_game_dolls...
2025-11-25 12:07:38,035      INFO      pipeline.utils.feature_engineering      Extracted doll data for 2 rows.
2025-11-25 12:07:38,035      INFO      pipeline.utils.staging                  mini_game_dolls done.
2025-11-25 12:07:38,035      INFO      pipeline.utils.staging                  Running currency_define_permanent...
2025-11-25 12:07:38,038      INFO      pipeline.utils.feature_engineering      Extracted permanent shop item data for 4 rows.
2025-11-25 12:07:38,038      INFO      pipeline.utils.staging                  currency_define_permanent done.
2025-11-25 12:07:38,038      INFO      pipeline.utils.staging                  Running currency_define_consumable...
2025-11-25 12:07:38,040      INFO      pipeline.utils.feature_engineering      Extracted consumable shop item data for 38 rows.
2025-11-25 12:07:38,040      INFO      pipeline.utils.staging                  currency_define_consumable done.
2025-11-25 12:07:38,040      INFO      pipeline.utils.staging                  Running currency_define_board...
2025-11-25 12:07:38,043      INFO      pipeline.utils.feature_engineering      Extracted board item data for 6 rows.
2025-11-25 12:07:38,043      INFO      pipeline.utils.staging                  currency_define_board done.
2025-11-25 12:07:38,043      INFO      pipeline.utils.staging                  Running currency_define_keys...
2025-11-25 12:07:38,044      INFO      pipeline.utils.feature_engineering      Defined keys in spent_to for 0 rows.
2025-11-25 12:07:38,044      INFO      pipeline.utils.staging                  currency_define_keys done.
2025-11-25 12:07:38,044      INFO      pipeline.utils.staging                  Running apply_value_maps...
2025-11-25 12:07:38,055      WARNING   pipeline.utils.cleaning_functions       'event_params__ad_shown_where' not found in DataFrame.
2025-11-25 12:07:38,059      INFO      pipeline.utils.staging                  apply_value_maps done.
2025-11-25 12:07:38,059      INFO      pipeline.utils.staging                  Running question_addressable_index...
2025-11-25 12:07:38,062      INFO      pipeline.utils.feature_engineering      Question address created for 2040 rows.
2025-11-25 12:07:38,062      INFO      pipeline.utils.staging                  question_addressable_index done.
2025-11-25 12:07:38,062      INFO      pipeline.utils.staging                  Running question_answer_wrong_zeros...
2025-11-25 12:07:38,063      INFO      pipeline.utils.feature_engineering      Filled NaN values in 'event_params__answered_wrong' with 0 for 'Question Completed' events.
2025-11-25 12:07:38,063      INFO      pipeline.utils.staging                  question_answer_wrong_zeros done.
2025-11-25 12:07:38,063      INFO      __main__                                Data pipeline executed successfully.
2025-11-25 12:07:38,063      INFO      __main__                                Generating dataframes...
2025-11-25 12:07:38,163      INFO      pipeline.utils.split_functions          Session-level dataframe created with 17 records and 27 columns.
2025-11-25 12:07:38,186      INFO      pipeline.utils.split_functions          User-level dataframe created with 6 records and 23 columns.
2025-11-25 12:07:38,195      INFO      pipeline.utils.split_functions          Question-level dataframe created with 411 records and 22 columns.
2025-11-25 12:07:38,198      INFO      pipeline.utils.split_functions          Rewarded ads dataframe created with 124 records and 20 columns.
2025-11-25 12:07:38,214      INFO      pipeline.utils.split_functions          Date-level dataframe created with 5 records and 14 columns.
2025-11-25 12:07:38,221      INFO      pipeline.utils.split_functions          Technical events dataframe created with 6 records and 163 columns.
2025-11-25 12:07:38,228      INFO      pipeline.utils.dataframes               All split dataframes successfully created.
2025-11-25 12:07:38,228      INFO      __main__                                Dataframes generated successfully.
2025-11-25 12:07:38,228      INFO      __main__                                Calculating KPIs...
2025-11-25 12:07:38,248      INFO      pipeline.utils.calculate_kpis           ✅ KPIs calculated.
2025-11-25 12:07:38,456      INFO      __main__                                Data pipeline complete. Processed data saved.
2025-11-25 12:16:10,181      INFO      __main__                                Starting pipeline...
2025-11-25 12:16:10,181      INFO      __main__                                Validating folder structure...
2025-11-25 12:16:10,181      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/csv
2025-11-25 12:16:10,182      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/data/parquet
2025-11-25 12:16:10,182      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/logs
2025-11-25 12:16:10,182      INFO      pipeline.utils.main_functions           Directory exists or created: /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/docs
2025-11-25 12:16:10,182      INFO      pipeline.utils.main_functions           All folder structures validated.
2025-11-25 12:16:10,182      INFO      __main__                                Initializing BigQuery client...
2025-11-25 12:16:10,184      INFO      __main__                                BigQuery client initialized.
2025-11-25 12:16:10,185      INFO      __main__                                Starting data pull...
2025-11-25 12:16:10,197      INFO      pipeline.utils.staging                  Running pull_from_bq...
2025-11-25 12:16:11,818      INFO      pipeline.utils.pull_functions           No new tables to process.
2025-11-25 12:16:11,818      INFO      pipeline.utils.pull_functions           Merging data...
2025-11-25 12:16:12,030      INFO      pipeline.utils.staging                  pull_from_bq done.
2025-11-25 12:16:12,031      INFO      pipeline.utils.staging                  Running filter_events_by_date...
2025-11-25 12:16:12,033      INFO      pipeline.utils.main_functions           Filtered events from 2676 to 2204 based on start date 2025-11-20 00:00:00+00:00.
2025-11-25 12:16:12,034      INFO      pipeline.utils.staging                  filter_events_by_date done.
2025-11-25 12:16:12,034      INFO      pipeline.utils.staging                  Running flatten_dataframe...
2025-11-25 12:16:12,427      INFO      pipeline.utils.staging                  flatten_dataframe done.
2025-11-25 12:16:12,427      INFO      pipeline.utils.staging                  Running dots_to_underscores...
2025-11-25 12:16:12,427      INFO      pipeline.utils.cleaning_functions       Column names updated to use '__' instead of '.' successfully.
2025-11-25 12:16:12,428      INFO      pipeline.utils.staging                  dots_to_underscores done.
2025-11-25 12:16:12,428      INFO      pipeline.utils.staging                  Running transform_datetime_fields...
2025-11-25 12:16:12,440      INFO      pipeline.utils.time_and_date_functions  Date/time cleanup and transformation complete.
2025-11-25 12:16:12,441      INFO      pipeline.utils.staging                  transform_datetime_fields done.
2025-11-25 12:16:12,441      INFO      pipeline.utils.staging                  Running add_time_based_features...
2025-11-25 12:16:12,445      INFO      pipeline.utils.time_and_date_functions  Time-based features added successfully.
2025-11-25 12:16:12,445      INFO      pipeline.utils.staging                  add_time_based_features done.
2025-11-25 12:16:12,445      INFO      pipeline.utils.staging                  Running add_durations...
2025-11-25 12:16:12,496      INFO      pipeline.utils.time_and_date_functions  Session IDs assigned and durations calculated for 24 unique sessions.
2025-11-25 12:16:12,501      INFO      pipeline.utils.time_and_date_functions  Event durations within sessions calculated successfully.
2025-11-25 12:16:12,501      INFO      pipeline.utils.staging                  add_durations done.
2025-11-25 12:16:12,501      INFO      pipeline.utils.staging                  Running forward_fill_progress...
2025-11-25 12:16:12,512      INFO      pipeline.utils.feature_engineering      Character names, tiers, and question indices forward-filled for 24 unique sessions.
2025-11-25 12:16:12,513      INFO      pipeline.utils.staging                  forward_fill_progress done.
2025-11-25 12:16:12,513      INFO      pipeline.utils.staging                  Running question_index_cleanup...
2025-11-25 12:16:12,522      INFO      pipeline.utils.cleaning_functions       Question index cleaned up for 2040 rows.
2025-11-25 12:16:12,522      INFO      pipeline.utils.staging                  question_index_cleanup done.
2025-11-25 12:16:12,522      INFO      pipeline.utils.staging                  Running question_cumulative_qi...
2025-11-25 12:16:12,529      INFO      pipeline.utils.feature_engineering      Cumulative question index calculated for 2040 rows.
2025-11-25 12:16:12,529      INFO      pipeline.utils.staging                  question_cumulative_qi done.
2025-11-25 12:16:12,529      INFO      pipeline.utils.staging                  Running mini_game_features...
2025-11-25 12:16:12,532      INFO      pipeline.utils.feature_engineering      Extracted maze hand data for 16 rows.
2025-11-25 12:16:12,532      INFO      pipeline.utils.staging                  mini_game_features done.
2025-11-25 12:16:12,533      INFO      pipeline.utils.staging                  Running mini_game_reward_split...
2025-11-25 12:16:12,537      INFO      pipeline.utils.feature_engineering      Extracted buff data for 9 rows.
2025-11-25 12:16:12,537      INFO      pipeline.utils.staging                  mini_game_reward_split done.
2025-11-25 12:16:12,537      INFO      pipeline.utils.staging                  Running mini_game_buffs...
2025-11-25 12:16:12,539      INFO      pipeline.utils.feature_engineering      Extracted earned buff data for 4 rows.
2025-11-25 12:16:12,539      INFO      pipeline.utils.staging                  mini_game_buffs done.
2025-11-25 12:16:12,539      INFO      pipeline.utils.staging                  Running mini_game_dolls...
2025-11-25 12:16:12,541      INFO      pipeline.utils.feature_engineering      Extracted doll data for 2 rows.
2025-11-25 12:16:12,541      INFO      pipeline.utils.staging                  mini_game_dolls done.
2025-11-25 12:16:12,542      INFO      pipeline.utils.staging                  Running currency_define_permanent...
2025-11-25 12:16:12,544      INFO      pipeline.utils.feature_engineering      Extracted permanent shop item data for 4 rows.
2025-11-25 12:16:12,544      INFO      pipeline.utils.staging                  currency_define_permanent done.
2025-11-25 12:16:12,544      INFO      pipeline.utils.staging                  Running currency_define_consumable...
2025-11-25 12:16:12,546      INFO      pipeline.utils.feature_engineering      Extracted consumable shop item data for 38 rows.
2025-11-25 12:16:12,546      INFO      pipeline.utils.staging                  currency_define_consumable done.
2025-11-25 12:16:12,546      INFO      pipeline.utils.staging                  Running currency_define_board...
2025-11-25 12:16:12,548      INFO      pipeline.utils.feature_engineering      Extracted board item data for 6 rows.
2025-11-25 12:16:12,548      INFO      pipeline.utils.staging                  currency_define_board done.
2025-11-25 12:16:12,548      INFO      pipeline.utils.staging                  Running currency_define_keys...
2025-11-25 12:16:12,549      INFO      pipeline.utils.feature_engineering      Defined keys in spent_to for 0 rows.
2025-11-25 12:16:12,549      INFO      pipeline.utils.staging                  currency_define_keys done.
2025-11-25 12:16:12,549      INFO      pipeline.utils.staging                  Running apply_value_maps...
2025-11-25 12:16:12,560      WARNING   pipeline.utils.cleaning_functions       'event_params__ad_shown_where' not found in DataFrame.
2025-11-25 12:16:12,564      INFO      pipeline.utils.staging                  apply_value_maps done.
2025-11-25 12:16:12,564      INFO      pipeline.utils.staging                  Running question_addressable_index...
2025-11-25 12:16:12,567      INFO      pipeline.utils.feature_engineering      Question address created for 2040 rows.
2025-11-25 12:16:12,567      INFO      pipeline.utils.staging                  question_addressable_index done.
2025-11-25 12:16:12,567      INFO      pipeline.utils.staging                  Running question_answer_wrong_zeros...
2025-11-25 12:16:12,568      INFO      pipeline.utils.feature_engineering      Filled NaN values in 'event_params__answered_wrong' with 0 for 'Question Completed' events.
2025-11-25 12:16:12,568      INFO      pipeline.utils.staging                  question_answer_wrong_zeros done.
2025-11-25 12:16:12,568      INFO      __main__                                Data pipeline executed successfully.
2025-11-25 12:16:12,568      INFO      __main__                                Generating dataframes...
2025-11-25 12:16:12,670      INFO      pipeline.utils.split_functions          Session-level dataframe created with 17 records and 27 columns.
2025-11-25 12:16:12,694      INFO      pipeline.utils.split_functions          User-level dataframe created with 6 records and 23 columns.
2025-11-25 12:16:12,703      INFO      pipeline.utils.split_functions          Question-level dataframe created with 411 records and 22 columns.
2025-11-25 12:16:12,706      INFO      pipeline.utils.split_functions          Rewarded ads dataframe created with 124 records and 20 columns.
2025-11-25 12:16:12,722      INFO      pipeline.utils.split_functions          Date-level dataframe created with 5 records and 14 columns.
2025-11-25 12:16:12,729      INFO      pipeline.utils.split_functions          Technical events dataframe created with 6 records and 163 columns.
2025-11-25 12:16:12,737      INFO      pipeline.utils.dataframes               All split dataframes successfully created.
2025-11-25 12:16:12,737      INFO      __main__                                Dataframes generated successfully.
2025-11-25 12:16:12,737      INFO      __main__                                Calculating KPIs...
2025-11-25 12:16:12,759      INFO      pipeline.utils.calculate_kpis           ✅ KPIs calculated.
2025-11-25 12:16:12,961      INFO      __main__                                Data pipeline complete. Processed data saved.
2025-11-25 12:16:13,358      INFO      pipeline.utils.reporting                Report generated at /home/runner/work/emoji-oracle-analytics/emoji-oracle-analytics/docs
